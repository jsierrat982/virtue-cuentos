<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- T√≠tulo de la p√°gina que aparece en la pesta√±a del navegador -->
    <title>VIRTUE CUENTOS</title>
    <!-- Incluye el CDN de Tailwind CSS para un dise√±o responsivo y moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluye la fuente Inter de Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!-- Define una fuente global y los estilos personalizados para los botones -->
    <style>
        /* Define una fuente global para toda la p√°gina */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Oculta los elementos que no corresponden a la categor√≠a seleccionada */
        .hidden-category {
            display: none;
        }

        /* Estilos base del bot√≥n */
        .button {
            background-color: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
            outline: none;
            transition: transform 0.2s ease-in-out;
        }

        .button:active {
            transform: scale(0.95);
        }

        .button-outer {
            position: relative;
            padding: 4px;
            border-radius: 9999px;
            background: linear-gradient(145deg, #e6e6e6, #ffffff);
            box-shadow: 6px 6px 12px #d9d9d9, -6px -6px 12px #ffffff;
            transition: all 0.2s ease-in-out;
        }

        .button:hover .button-outer {
            box-shadow: 3px 3px 6px #d9d9d9, -3px -3px 6px #ffffff;
        }

        .button-inner {
            padding: 8px 16px;
            border-radius: 9999px;
            background-color: #f0f0f0;
            box-shadow: inset 2px 2px 4px #d9d9d9, inset -2px -2px 4px #ffffff;
            color: #555;
            transition: all 0.2s ease-in-out;
        }
        
        /* --- Estilos de botones activos por color --- */

        /* Color por defecto (TODOS - Azul) */
        .button.active .button-outer {
            background: linear-gradient(145deg, #5a9fff, #4285f4);
            box-shadow: 6px 6px 12px #4285f470, -6px -6px 12px #ffffff;
        }
        .button.active .button-inner {
            background-color: #4285f4;
            box-shadow: inset 2px 2px 4px #3371e7, inset -2px -2px 4px #519aff;
            color: #fff;
        }

        /* Honestidad (Verde) */
        .button.btn-honestidad.active .button-outer { background: linear-gradient(145deg, #66bb6a, #4caf50); box-shadow: 6px 6px 12px #43a04770, -6px -6px 12px #ffffff; }
        .button.btn-honestidad.active .button-inner { background-color: #4caf50; box-shadow: inset 2px 2px 4px #388e3c, inset -2px -2px 4px #81c784; }

        /* Generosidad (Naranja) */
        .button.btn-generosidad.active .button-outer { background: linear-gradient(145deg, #ffa726, #fb8c00); box-shadow: 6px 6px 12px #f57c0070, -6px -6px 12px #ffffff; }
        .button.btn-generosidad.active .button-inner { background-color: #fb8c00; box-shadow: inset 2px 2px 4px #ef6c00, inset -2px -2px 4px #ff9800; }

        /* Respeto (Morado) */
        .button.btn-respeto.active .button-outer { background: linear-gradient(145deg, #ab47bc, #9c27b0); box-shadow: 6px 6px 12px #8e24aa70, -6px -6px 12px #ffffff; }
        .button.btn-respeto.active .button-inner { background-color: #9c27b0; box-shadow: inset 2px 2px 4px #7b1fa2, inset -2px -2px 4px #ba68c8; }

        /* Empat√≠a (Turquesa) */
        .button.btn-empatia.active .button-outer { background: linear-gradient(145deg, #26a69a, #009688); box-shadow: 6px 6px 12px #00897b70, -6px -6px 12px #ffffff; }
        .button.btn-empatia.active .button-inner { background-color: #009688; box-shadow: inset 2px 2px 4px #00796b, inset -2px -2px 4px #4db6ac; }

        /* Responsabilidad (Rojo) */
        .button.btn-responsabilidad.active .button-outer { background: linear-gradient(145deg, #ef5350, #f44336); box-shadow: 6px 6px 12px #e5393570, -6px -6px 12px #ffffff; }
        .button.btn-responsabilidad.active .button-inner { background-color: #f44336; box-shadow: inset 2px 2px 4px #d32f2f, inset -2px -2px 4px #e57373; }

        /* Amistad (Amarillo) */
        .button.btn-amistad.active .button-outer { background: linear-gradient(145deg, #ffee58, #fdd835); box-shadow: 6px 6px 12px #fbc02d70, -6px -6px 12px #ffffff; }
        .button.btn-amistad.active .button-inner { background-color: #fdd835; box-shadow: inset 2px 2px 4px #f9a825, inset -2px -2px 4px #fff176; color: #424242; }

        /* Estilos para el nuevo fondo de imagen en el encabezado */
        .header-with-bg {
            background-image: url('https://github.com/jsierrat982/virtue-cuentos/blob/main/animales_de_la_selva.png?raw=true');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white; /* Cambia el color del texto para que sea visible */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6); /* Agrega sombra al texto para mejor legibilidad */
        }
    </style>
</head>
<body class="bg-gradient-to-r from-blue-100 to-purple-200 text-gray-800">

    <!-- Contenedor principal de la p√°gina, centrado y con m√°rgenes -->
    <div class="container mx-auto p-4 md:p-8">

        <!-- Encabezado de la p√°gina con la nueva imagen de fondo -->
        <header class="header-with-bg rounded-xl shadow-lg p-6 mb-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">VIRTUE CUENTOS</h1>
            <p class="text-xl md:text-2xl">Cuentos para inspirar la imaginaci√≥n.</p>
        </header>

        <!-- Secci√≥n de video cuentos -->
        <main class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-8">
            <!-- T√≠tulo de la secci√≥n de videos -->
            <h2 class="text-2xl md:text-3xl font-semibold text-blue-600 mb-6">Nuestros Video Cuentos</h2>

            <!-- Barra de navegaci√≥n para las categor√≠as, con los nuevos botones -->
            <nav class="flex flex-wrap justify-center gap-4 mb-6">
                <!-- Bot√≥n para mostrar todos los videos -->
                <button onclick="filterVideos('all', this)" class="button active">
                    <div class="button-outer"><div class="button-inner"><span>TODOS</span></div></div>
                </button>
                <!-- Botones para filtrar por categor√≠a -->
                <button onclick="filterVideos('honestidad', this)" class="button btn-honestidad">
                    <div class="button-outer"><div class="button-inner"><span>HONESTIDAD</span></div></div>
                </button>
                <button onclick="filterVideos('generosidad', this)" class="button btn-generosidad">
                    <div class="button-outer"><div class="button-inner"><span>GENEROSIDAD</span></div></div>
                </button>
                <button onclick="filterVideos('respeto', this)" class="button btn-respeto">
                    <div class="button-outer"><div class="button-inner"><span>RESPETO</span></div></div>
                </button>
                <button onclick="filterVideos('empatia', this)" class="button btn-empatia">
                    <div class="button-outer"><div class="button-inner"><span>EMPAT√çA</span></div></div>
                </button>
                <button onclick="filterVideos('responsabilidad', this)" class="button btn-responsabilidad">
                    <div class="button-outer"><div class="button-inner"><span>RESPONSABILIDAD</span></div></div>
                </button>
                <button onclick="filterVideos('amistad', this)" class="button btn-amistad">
                    <div class="button-outer"><div class="button-inner"><span>AMISTAD</span></div></div>
                </button>
            </nav>

            <!-- Contenedor de la cuadr√≠cula para los videos -->
            <div id="video-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

                <!-- Tarjeta de video 1: Empat√≠a -->
                <div class="video-card categoria-empatia bg-blue-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/L1m41Q9t3z4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-blue-800 mb-2">El Valor de la Empat√≠a</h3>
                        <p class="text-gray-600">Un cuento que ense√±a a ponerse en el lugar de los dem√°s.</p>
                    </div>
                </div>

                <!-- Tarjeta de video 2: Honestidad -->
                <div class="video-card categoria-honestidad bg-green-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/g2qF7z-T4yI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-green-800 mb-2">La Importancia de la Honestidad</h3>
                        <p class="text-gray-600">Una historia para aprender sobre ser honesto y decir la verdad.</p>
                    </div>
                </div>

                <!-- Tarjeta de video 3: Amistad -->
                <div class="video-card categoria-amistad bg-yellow-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/n4f7-eYw9jM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-yellow-800 mb-2">El Valor de la Amistad</h3>
                        <p class="text-gray-600">Un cuento sobre la importancia de la amistad y el compa√±erismo.</p>
                    </div>
                </div>

                <!-- Tarjeta de video 4: Generosidad -->
                <div class="video-card categoria-generosidad bg-blue-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/409k_T89J1s" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-blue-800 mb-2">La Generosidad del Sol</h3>
                        <p class="text-gray-600">Una historia sobre dar sin esperar nada a cambio.</p>
                    </div>
                </div>

                <!-- Tarjeta de video 5: Respeto -->
                <div class="video-card categoria-respeto bg-green-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/8-qgV_t7jD4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-green-800 mb-2">El Respeto a los Mayores</h3>
                        <p class="text-gray-600">Un cuento para aprender a valorar y escuchar a los mayores.</p>
                    </div>
                </div>

                <!-- Tarjeta de video 6: Responsabilidad -->
                <div class="video-card categoria-responsabilidad bg-yellow-50 rounded-lg shadow-md overflow-hidden p-4">
                    <div class="aspect-video w-full">
                        <iframe class="w-full h-full rounded-lg" src="https://www.youtube.com/embed/1d1n2bA-4eI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-xl font-bold text-yellow-800 mb-2">Mi Responsabilidad en Casa</h3>
                        <p class="text-gray-600">Una historia que ense√±a a los ni√±os a ser responsables.</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- Secci√≥n para crear cuentos con Gemini -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mt-8">
            <h2 class="text-2xl md:text-3xl font-semibold text-blue-600 mb-6">Crea tu Propio Cuento ‚ú®</h2>
            <div class="space-y-4">
                <div>
                    <label for="virtue-select" class="block text-gray-700 font-medium mb-1">Selecciona una virtud:</label>
                    <select id="virtue-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow duration-200">
                        <option value="honestidad">Honestidad</option>
                        <option value="generosidad">Generosidad</option>
                        <option value="respeto">Respeto</option>
                        <option value="empatia">Empat√≠a</option>
                        <option value="responsabilidad">Responsabilidad</option>
                        <option value="amistad">Amistad</option>
                    </select>
                </div>
                <div>
                    <label for="character-input" class="block text-gray-700 font-medium mb-1">A√±ade un personaje o detalle (opcional):</label>
                    <input type="text" id="character-input" placeholder="Ej: 'un oso valiente' o 'en un bosque m√°gico'" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow duration-200">
                </div>
                <button onclick="generateStory()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center space-x-2">
                    <span>Generar Cuento</span>
                    <span role="img" aria-label="sparkles">‚ú®</span>
                </button>
            </div>
            <div id="story-output" class="mt-8 p-6 bg-gray-50 rounded-lg shadow-inner hidden">
                <div id="loading-indicator" class="hidden text-center text-gray-500">
                    <p>Generando tu cuento, por favor espera...</p>
                </div>
                <div id="story-content" class="whitespace-pre-wrap text-gray-700 leading-relaxed"></div>
            </div>
            <div id="error-message" class="hidden mt-4 text-red-600 text-center"></div>
        </section>

        <!-- Secci√≥n de subida de archivos -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mt-8">
            <h2 class="text-2xl md:text-3xl font-semibold text-blue-600 mb-6">Sube tu Propio Cuento üìÑ</h2>
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                <label for="file-upload-input" class="cursor-pointer block">
                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28m0 0l4 4m4-4l1.172-1.172a4 4 0 00-5.656 0L28 28m0 0l-4 4m4-4l4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <span class="mt-2 block text-sm font-medium text-gray-900">
                        Arrastra y suelta un archivo o <span class="text-blue-600 hover:text-blue-800 font-semibold">haz clic para subir</span>
                    </span>
                    <input id="file-upload-input" name="file-upload" type="file" class="sr-only" onchange="displayFileName(this.files)" />
                </label>
            </div>
            <div id="upload-message" class="mt-4 p-4 text-center rounded-lg text-gray-700 hidden"></div>
        </section>

        <!-- Pie de p√°gina (Footer) -->
        <footer class="text-center mt-8 text-gray-500">
            <div class="mb-4">
                <p class="mb-2">S√≠guenos en nuestras redes sociales:</p>
                <div class="flex justify-center space-x-4">
                    <!-- Enlace para Instagram -->
                    <a href="#" class="text-pink-500 hover:text-pink-600 transition-colors duration-200">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2c-2.717 0-3.056.01-4.122.06-1.065.05-1.79.22-2.428.46-.66.25-1.217.59-1.773 1.15-.56.56- .9 1.11-1.15 1.77C2.27 6.94 2.1 7.67 2.05 8.73c-.05 1.06-.06 1.4-.06 4.12s.01 3.06.06 4.12c.05 1.06.22 1.79.46 2.43.25.66.59 1.21 1.15 1.77.56.56 1.11.9 1.77 1.15 1.67.6 2.4.72 4.12.77 1.06.05 1.4.06 4.12.06s3.06-.01 4.12-.06c1.06-.05 1.79-.22 2.43-.46.66-.25 1.21-.59 1.77-1.15.56-.56.9-1.11 1.15-1.77.46-1.67.72-2.4.77-4.12.05-1.06.06-1.4.06-4.12s-.01-3.06-.06-4.12c-.05-1.06-.22-1.79-.46-2.43-.25-.66-.59-1.21-1.15-1.77-.56-.56-1.11-.9-1.77-1.15-1.67-.6-2.4-.72-4.12-.77C15.056 2.01 14.717 2 12 2zm0 1.8c2.65 0 2.96.01 4.01.06 1.02.05 1.58.21 1.94.35.45.18.77.39 1.12.74.35.35.56.67.74 1.12.14.36.3.92.35 1.94.05 1.05.06 1.36.06 4.01s-.01 2.96-.06 4.01c-.05 1.02-.21 1.58-.35 1.94-.18.45-.39.77-.74 1.12-.35.35-.67.56-1.12.74-.36.14-.92.3-1.94.35-1.05.05-1.36.06-4.01.06s-2.96-.01-4.01-.06c-1.02-.05-1.58-.21-1.94-.35-.45-.18-.77-.39-1.12-.74-.35-.35-.56-.67-.74-1.12-.14-.36-.3-.92-.35-1.94-.05-1.05-.06-1.36-.06-4.01s.01-2.96.06-4.01c.05-1.02.21-1.58.35-1.94.18-.45.39.77.74-1.12.35-.35.67-.56 1.12-.74.36-.14.92-.3 1.94-.35C9.04 3.81 9.35 3.8 12 3.8zm0 3.35c-2.6 0-4.7 2.1-4.7 4.7s2.1 4.7 4.7 4.7 4.7-2.1 4.7-4.7-2.1-4.7-4.7-4.7zm0 7.6c-1.6 0-2.9-1.3-2.9-2.9s1.3-2.9 2.9-2.9 2.9 1.3 2.9 2.9-1.3 2.9-2.9 2.9zm5.3-7.8c-.6 0-1.1.5-1.1 1.1s.5 1.1 1.1 1.1 1.1-.5 1.1-1.1-.5-1.1-1.1-1.1z" clip-rule="evenodd"/></svg>
                    </a>
                    <!-- Enlace para TikTok -->
                    <a href="#" class="text-black hover:text-gray-700 transition-colors duration-200">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-2.43.03-4.83-.95-6.43-2.98-1.5-1.9-2.16-4.36-1.8-6.72.32-2.15 1.51-4.15 3.58-5.18 2.11-1.04 4.4-.98 6.36.16v4.03c-1.31-.38-2.69-.06-3.78.85-1.04.9-1.62 2.25-1.58 3.58.05 1.34.61 2.66 1.64 3.58 1.03.92 2.36 1.25 3.64.97.02-3.55.01-7.1-.02-10.65Z"/></svg>
                    </a>
                    <!-- Enlace para YouTube -->
                    <a href="#" class="text-red-500 hover:text-red-600 transition-colors duration-200">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M10,15L15.19,12L10,9V15M21.56,7.17C21.69,7.64 21.78,8.27 21.84,9.07C21.91,9.87 21.94,10.56 21.94,11.16L22,12C22,14.19 21.84,15.8 21.56,16.83C21.31,17.73 20.73,18.31 19.83,18.56C19.36,18.69 18.73,18.78 17.93,18.84C17.13,18.91 16.44,18.94 15.84,18.94L15,19C12.81,19 11.2,18.84 10.17,18.56C9.27,18.31 8.69,17.73 8.44,16.83C8.31,16.36 8.22,15.73 8.16,14.93C8.09,14.13 8.06,13.44 8.06,12.84L8,12C8,9.81 8.16,8.2 8.44,7.17C8.69,6.27 9.27,5.69 10.17,5.44C11.2,5.16 12.81,5 15,5L15.84,5.06C16.44,5.06 17.13,5.09 17.93,5.16C18.73,5.22 19.36,5.31 19.83,5.44C20.73,5.69 21.31,6.27 21.56,7.17Z"></svg>
                    </a>
                </div>
            </div>
            <p>&copy; 2025 Virtue Cuentos. Todos los derechos reservados.</p>
        </footer>

    </div>

    <script>
        // Funci√≥n para filtrar videos por categor√≠a
        function filterVideos(category, selectedButton) {
            const videoCards = document.querySelectorAll('.video-card');
            const buttons = document.querySelectorAll('nav .button');

            // Quita la clase 'active' de todos los botones
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            // A√±ade la clase 'active' al bot√≥n seleccionado
            selectedButton.classList.add('active');

            // Muestra u oculta las tarjetas de video seg√∫n la categor√≠a
            videoCards.forEach(card => {
                if (category === 'all' || card.classList.contains(`categoria-${category}`)) {
                    card.classList.remove('hidden-category');
                } else {
                    card.classList.add('hidden-category');
                }
            });
        }

        // Funci√≥n as√≠ncrona para generar un cuento usando la API de Gemini
        async function generateStory() {
            const virtueSelect = document.getElementById('virtue-select');
            const characterInput = document.getElementById('character-input');
            const storyOutput = document.getElementById('story-output');
            const loadingIndicator = document.getElementById('loading-indicator');
            const storyContent = document.getElementById('story-content');
            const errorMessage = document.getElementById('error-message');

            const selectedVirtue = virtueSelect.value;
            const characterDetail = characterInput.value.trim();

            storyOutput.classList.remove('hidden');
            storyContent.innerText = '';
            errorMessage.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');

            let prompt = `Escribe un cuento infantil corto (2-3 p√°rrafos) que ejemplifique la virtud de la ${selectedVirtue}.`;
            if (characterDetail) {
                prompt += ` El cuento debe incluir el siguiente detalle: ${characterDetail}.`;
            }

            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`Error de respuesta de la API: ${response.statusText}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0]) {
                    storyContent.innerText = result.candidates[0].content.parts[0].text;
                } else {
                    throw new Error('Estructura de respuesta de la API no v√°lida.');
                }

            } catch (error) {
                console.error("Error al generar el cuento:", error);
                errorMessage.innerText = 'No se pudo generar el cuento. Por favor, int√©ntalo de nuevo.';
                errorMessage.classList.remove('hidden');
                storyContent.innerText = '';
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }
        
        // Funci√≥n para mostrar el nombre del archivo seleccionado
        function displayFileName(files) {
            const uploadMessage = document.getElementById('upload-message');
            uploadMessage.classList.remove('hidden', 'text-green-700', 'bg-green-50', 'text-red-700', 'bg-red-50');
            
            if (files.length > 0) {
                const fileName = files[0].name;
                uploadMessage.innerText = `Archivo seleccionado: ${fileName}. La subida de archivo real requiere un servidor.`;
                uploadMessage.classList.add('text-green-700', 'bg-green-50');
            } else {
                uploadMessage.innerText = 'No se seleccion√≥ ning√∫n archivo.';
                uploadMessage.classList.add('text-red-700', 'bg-red-50');
            }
            uploadMessage.classList.remove('hidden');
        }
    </script>

</body>
</html>
